{% extends "base.html" %}
{% load tz %}

{% block title %}‡∏á‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£{% endblock %}

<link rel="stylesheet" href="https://cdn.datatables.net/1.13.8/css/dataTables.bootstrap5.min.css">

{% block content %}
<div class="container-fluid">

    <h4 class="fw-bold mb-4">
        üõ† ‡∏á‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£ (Accepting work)
    </h4>

    {% if tickets %}
    <div class="card shadow-sm">
        <div class="table-responsive">
            <table id="acceptingWorkTable" class="table table-hover align-middle mb-0">
                <thead class="table-light">
                    <tr>
                        <th class="text-center">‡∏•‡∏≥‡∏î‡∏±‡∏ö</th>
                        <th>‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó</th>
                        <th>‡∏´‡∏±‡∏ß‡∏Ç‡πâ‡∏≠</th>
                        <th>‡∏ú‡∏π‡πâ‡πÅ‡∏à‡πâ‡∏á</th>
                        <th>‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡πÅ‡∏à‡πâ‡∏á</th>
                        <th class="text-center">‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£</th>
                    </tr>
                </thead>
                <tbody>
                    {% for t in tickets %}
                    <tr>
                        <td class="text-center fw-bold text-muted">
                            {{ t.id }}
                        </td>
                        <td>{{ t.ticket_type }}</td>
                        <td class="fw-semibold">{{ t.title }}</td>
                        <td>{{ t.username }}</td>
                        <td>
                            <div>{{ t.create_at|date:"d M Y" }}</div>
                            <small class="text-muted">
                                {{ t.create_at|date:"H:i" }} ‡∏ô.
                            </small>
                        </td>
                        <td class="text-center">
                            {% if t.status_id == 8 %}
                            <form method="post"
                                  action="{% url 'admin_complete_ticket' t.id %}"
                                  onsubmit="return confirm('‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏ß‡πà‡∏≤‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡πÄ‡∏™‡∏£‡πá‡∏à‡πÅ‡∏•‡πâ‡∏ß?');">
                                {% csrf_token %}
                                <button type="submit" class="btn btn-sm btn-success">
                                    ‡πÄ‡∏™‡∏£‡πá‡∏à‡∏á‡∏≤‡∏ô
                                </button>
                            </form>
                            {% else %}
                            <span class="text-muted small">-</span>
                            {% endif %}
                        </td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
    </div>
    {% else %}
    <div class="alert alert-secondary">
        ‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏á‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£
    </div>
    {% endif %}

</div>

<script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
<script src="https://cdn.datatables.net/1.13.8/js/jquery.dataTables.min.js"></script>
<script src="https://cdn.datatables.net/1.13.8/js/dataTables.bootstrap5.min.js"></script>

<script>
    $(function () {
        $('#acceptingWorkTable').DataTable({
            pageLength: 10,
            order: [[4, 'desc']],
            language: {
                zeroRecords: "‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•"
            },
            columnDefs: [
                { orderable: false, targets: 5 }
            ]
        });
    });
</script>

{% endblock %}
